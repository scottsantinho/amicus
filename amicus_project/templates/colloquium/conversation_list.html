{% extends 'nucleus/base.html' %}

{% block content %}
<h2>Your Conversations</h2>

{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

<form method="post" action="{% url 'delete_conversations' %}">
    {% csrf_token %}
    {% for conversation in conversations %}
    <div>
        <input type="checkbox" name="conversation_ids" value="{{ conversation.id }}" id="conv_{{ conversation.id }}">
        <label for="conv_{{ conversation.id }}">
            <a href="{% url 'conversation_detail' conversation.id %}">
                {{ conversation.created_at|date:"F d, Y" }} - {{ conversation.messages.first.content|truncatechars:50 }}
            </a>
        </label>
    </div>
    {% empty %}
    <p>No conversations yet.</p>
    {% endfor %}
    
    {% if conversations %}
    <button type="submit">Delete Selected</button>
    {% endif %}
</form>

<a href="{% url 'new_conversation' %}">Start New Conversation</a>
{% endblock %}
